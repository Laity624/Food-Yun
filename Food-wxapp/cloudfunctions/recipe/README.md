# èœè°±äº‘å‡½æ•° - å®¶åº­ç‰ˆ

æœ¬äº‘å‡½æ•°å·²æ›´æ–°ä¸ºæ”¯æŒå®¶åº­ç‰ˆèœè°±åˆ†ç±»ç³»ç»Ÿï¼ŒåŒ…å«åœºæ™¯åˆ†ç±»ã€é£Ÿæåˆ†ç±»å’Œå¯é€‰æ ‡ç­¾åŠŸèƒ½ã€‚

## ğŸ”„ æ›´æ–°å†…å®¹

### æ•°æ®ç»“æ„å˜æ›´
- **èœè°±åç§°**: `title` â†’ `name`
- **åœºæ™¯åˆ†ç±»**: æ–°å¢ `sceneCategory` (å¿…å¡«)
- **é£Ÿæåˆ†ç±»**: æ–°å¢ `ingredientCategory` (å¿…å¡«)
- **å¯é€‰æ ‡ç­¾**: `tags` â†’ `optionalTags`
- **åˆ¶ä½œä¿¡æ¯**: `cookTime/difficulty/serving` â†’ `preparationTime/difficulty/servingSize`

### æ–°å¢åŠŸèƒ½
- åœºæ™¯åˆ†ç±»ç­›é€‰ (æ—¥å¸¸å®¶å¸¸èœã€å¿«æ‰‹èœã€å®´å®¢èœã€æ¸…æ·¡èœã€é‡å£å‘³èœ)
- é£Ÿæåˆ†ç±»ç­›é€‰ (è‚‰ç±»ã€æ°´äº§ã€è›‹ç±»ã€è”¬èœã€æ±¤ç±»ã€ä¸»é£Ÿ)
- å¯é€‰æ ‡ç­¾ç­›é€‰ (çƒ¹é¥ªæ–¹å¼ã€å£å‘³ç‰¹è‰²)
- æ•°æ®éªŒè¯å¢å¼º
- æ–°å¢ `getById` æ¥å£ç”¨äºç¼–è¾‘æ¨¡å¼

## ğŸ“‹ API æ¥å£

### 1. åˆ›å»ºèœè°± (create)
```javascript
{
  action: 'create',
  data: {
    name: 'èœè°±åç§°',                    // å¿…å¡«
    description: 'èœè°±æè¿°',             // å¯é€‰
    images: ['å›¾ç‰‡URL'],                // å¯é€‰
    sceneCategory: 'daily',            // å¿…å¡«ï¼šåœºæ™¯åˆ†ç±»ID
    ingredientCategory: 'meat',        // å¿…å¡«ï¼šé£Ÿæåˆ†ç±»ID  
    preparationTime: { value: '30', label: '30åˆ†é’Ÿ' },
    difficulty: { value: 1, label: 'ç®€å•', color: 'green' },
    servingSize: { value: '3-4', label: '3-4äºº' },
    optionalTags: ['stir_fry', 'sichuan'], // å¯é€‰æ ‡ç­¾IDæ•°ç»„
    ingredients: [                     // å¿…å¡«ï¼šé£Ÿææ¸…å•
      { id: 'ing_1', name: 'é£Ÿæå', amount: 'ç”¨é‡' }
    ],
    steps: [                          // å¿…å¡«ï¼šåˆ¶ä½œæ­¥éª¤
      { id: 'step_1', content: 'æ­¥éª¤æè¿°', image: 'å›¾ç‰‡URL' }
    ],
    isPublic: true,                   // æ˜¯å¦å…¬å¼€
    status: 'published'               // çŠ¶æ€ï¼šdraft/published
  }
}
```

### 2. è·å–èœè°±åˆ—è¡¨ (list)
```javascript
{
  action: 'list',
  page: 1,                           // é¡µç 
  pageSize: 10,                      // æ¯é¡µæ•°é‡
  search: 'æœç´¢å…³é”®è¯',                // å¯é€‰ï¼šæœç´¢èœè°±åç§°å’Œæè¿°
  sceneCategories: ['daily', 'quick'], // å¯é€‰ï¼šåœºæ™¯åˆ†ç±»ç­›é€‰
  ingredientCategories: ['meat'],     // å¯é€‰ï¼šé£Ÿæåˆ†ç±»ç­›é€‰
  optionalTags: ['stir_fry'],        // å¯é€‰ï¼šå¯é€‰æ ‡ç­¾ç­›é€‰
  creatorId: 'openid'                // å¯é€‰ï¼šæŒ‡å®šåˆ›å»ºè€…
}
```

### 3. è·å–èœè°±è¯¦æƒ… (detail)
```javascript
{
  action: 'detail',
  recipeId: 'èœè°±ID'
}
```

### 4. æ ¹æ®IDè·å–èœè°± (getById) - ç”¨äºç¼–è¾‘
```javascript
{
  action: 'getById',
  recipeId: 'èœè°±ID'
}
```

### 5. æ›´æ–°èœè°± (update)
```javascript
{
  action: 'update',
  recipeId: 'èœè°±ID',
  data: {
    // åŒåˆ›å»ºèœè°±çš„æ•°æ®ç»“æ„
  }
}
```

### 6. åˆ é™¤èœè°± (delete)
```javascript
{
  action: 'delete',
  recipeId: 'èœè°±ID'
}
```

## ğŸ·ï¸ åˆ†ç±»ç³»ç»Ÿ

### åœºæ™¯åˆ†ç±» (å¿…é€‰)
- `daily`: æ—¥å¸¸å®¶å¸¸èœ
- `quick`: å¿«æ‰‹èœ  
- `guest`: å®´å®¢èœ
- `light`: æ¸…æ·¡èœ
- `heavy`: é‡å£å‘³èœ

### é£Ÿæåˆ†ç±» (å¿…é€‰)
- `meat`: è‚‰ç±»
- `seafood`: æ°´äº§
- `egg`: è›‹ç±»
- `vegetable`: è”¬èœ
- `soup`: æ±¤ç±»
- `staple`: ä¸»é£Ÿ

### å¯é€‰æ ‡ç­¾
**çƒ¹é¥ªæ–¹å¼:**
- `stir_fry`: ç‚’èœ
- `steam`: è’¸èœ
- `stew`: ç‚–èœ
- `cold_mix`: å‡‰æ‹Œ
- `soup`: æ±¤å“
- `fry`: æ²¹ç‚¸
- `grill`: çƒ§çƒ¤
- `boil`: æ°´ç…®

**å£å‘³ç‰¹è‰²:**
- `sichuan`: å·èœ
- `cantonese`: ç²¤èœ
- `home_style`: å®¶å¸¸å‘³
- `light`: æ¸…æ·¡
- `spicy`: éº»è¾£
- `sweet`: ç”œå‘³
- `sour`: é…¸å‘³
- `fresh`: é²œé¦™

## ğŸš€ éƒ¨ç½²æ­¥éª¤

1. åœ¨å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­æ‰“å¼€é¡¹ç›®
2. å³é”®ç‚¹å‡» `cloudfunctions/recipe` æ–‡ä»¶å¤¹
3. é€‰æ‹©"åˆ›å»ºå¹¶éƒ¨ç½²ï¼šäº‘ç«¯å®‰è£…ä¾èµ–"
4. ç­‰å¾…éƒ¨ç½²å®Œæˆ

## ğŸ“Š æ•°æ®åº“ä¼˜åŒ–

å»ºè®®åœ¨äº‘å¼€å‘æ§åˆ¶å°ä¸º `recipes` é›†åˆæ·»åŠ ä»¥ä¸‹ç´¢å¼•ï¼š

```json
// åŸºç¡€æŸ¥è¯¢ç´¢å¼•
{ "isPublic": 1, "createdAt": -1 }

// åœºæ™¯åˆ†ç±»ç´¢å¼•
{ "sceneCategory": 1, "isPublic": 1, "createdAt": -1 }

// é£Ÿæåˆ†ç±»ç´¢å¼•  
{ "ingredientCategory": 1, "isPublic": 1, "createdAt": -1 }

// å¯é€‰æ ‡ç­¾ç´¢å¼•
{ "optionalTags": 1, "isPublic": 1, "createdAt": -1 }

// åˆ›å»ºè€…ç´¢å¼•
{ "creatorId": 1, "createdAt": -1 }
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®è¿ç§»**: å¦‚æœå·²æœ‰æ—§æ•°æ®ï¼Œéœ€è¦è¿›è¡Œæ•°æ®è¿ç§»ä»¥é€‚é…æ–°ç»“æ„
2. **æƒé™æ§åˆ¶**: ç¡®ä¿æ•°æ®åº“å®‰å…¨è§„åˆ™æ­£ç¡®é…ç½®
3. **ç´¢å¼•ä¼˜åŒ–**: æ ¹æ®å®é™…æŸ¥è¯¢éœ€æ±‚æ·»åŠ æ•°æ®åº“ç´¢å¼•
4. **æµ‹è¯•éªŒè¯**: éƒ¨ç½²åå»ºè®®è¿›è¡Œå®Œæ•´çš„åŠŸèƒ½æµ‹è¯•

## ğŸ§ª æµ‹è¯•

è¿è¡Œæµ‹è¯•æ–‡ä»¶éªŒè¯åŠŸèƒ½ï¼š
```bash
node test.js
```